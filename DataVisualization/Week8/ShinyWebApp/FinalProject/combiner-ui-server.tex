\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{}
    \pretitle{\vspace{\droptitle}}
  \posttitle{}
    \author{}
    \preauthor{}\postauthor{}
    \date{}
    \predate{}\postdate{}
  

\begin{document}

\#server.R Code

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#}
\CommentTok{# This is the server logic of a Shiny web application. You can run the}
\CommentTok{# application by clicking 'Run App' above.}
\CommentTok{#}
\CommentTok{# Find out more about building applications with Shiny here:}
\CommentTok{#}
\CommentTok{#    http://shiny.rstudio.com/}
\CommentTok{#}

\KeywordTok{library}\NormalTok{(shiny)}
\KeywordTok{library}\NormalTok{(tidyverse)}
\KeywordTok{library}\NormalTok{(maps)}
\KeywordTok{library}\NormalTok{(scales)}
\KeywordTok{library}\NormalTok{(sf)}
\KeywordTok{library}\NormalTok{(shinycssloaders)}
\NormalTok{lendingClubLoanData <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"data/lending_club_loan_data_final.csv"}\NormalTok{)}
\NormalTok{fullStateNames <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"data/states.csv"}\NormalTok{)}
\NormalTok{states <-}\StringTok{ }\KeywordTok{st_as_sf}\NormalTok{(}\KeywordTok{map}\NormalTok{(}\StringTok{"state"}\NormalTok{, }\DataTypeTok{plot =} \OtherTok{FALSE}\NormalTok{, }\DataTypeTok{fill =} \OtherTok{TRUE}\NormalTok{))}
\NormalTok{incomeLabels <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'0-20K'}\NormalTok{,}\StringTok{'20-40K'}\NormalTok{,}\StringTok{'40-60K'}\NormalTok{,}\StringTok{'60-80K'}\NormalTok{,}\StringTok{'80-100K'}\NormalTok{,}\StringTok{'100-120K'}\NormalTok{,}
                  \StringTok{'120-140K'}\NormalTok{,}\StringTok{'140-160K'}\NormalTok{,}\StringTok{'160-180K'}\NormalTok{,}\StringTok{'180-200K'}\NormalTok{, }\StringTok{'200-220K'}\NormalTok{, }
                  \StringTok{'220-240K'}\NormalTok{, }\StringTok{'240-260K'}\NormalTok{, }\StringTok{'260-280K'}\NormalTok{, }\StringTok{'280-300K'}\NormalTok{)}

\NormalTok{loan_statuses <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Current"}\NormalTok{,}
                   \StringTok{"Fully Paid"}\NormalTok{,}
                   \StringTok{"Late (31-120 days)"}\NormalTok{,}
                   \StringTok{"In Grace Period"}\NormalTok{,}
                   \StringTok{"Charged Off"}\NormalTok{,}
                   \StringTok{"Late (16-30 days)"}\NormalTok{)}

\NormalTok{filteredLendingClubData <-}\StringTok{ }\NormalTok{lendingClubLoanData }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{drop_na}\NormalTok{(annual_inc)}

\NormalTok{filtereDdtiData <-}\StringTok{ }\NormalTok{lendingClubLoanData }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{drop_na}\NormalTok{(dti)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{drop_na}\NormalTok{(dti) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{filter}\NormalTok{(dti }\OperatorTok{<}\StringTok{ }\DecValTok{100}\NormalTok{)}

\NormalTok{filteredAnnualIncomeData <-}\StringTok{ }\NormalTok{lendingClubLoanData }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{drop_na}\NormalTok{(annual_inc)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{filter}\NormalTok{(annual_inc }\OperatorTok{<}\StringTok{ }\DecValTok{300000}\NormalTok{)}


\CommentTok{# Define server logic required to draw a histogram}
\KeywordTok{shinyServer}\NormalTok{(}\ControlFlowTok{function}\NormalTok{(input, output) \{}
  
\NormalTok{  loanStatusFilter <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(loanStatusValue) \{}
\NormalTok{    toReturn <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Current"}\NormalTok{,}
                  \StringTok{"Fully Paid"}\NormalTok{,}
                  \StringTok{"Late (31-120 days)"}\NormalTok{,}
                  \StringTok{"In Grace Period"}\NormalTok{,}
                  \StringTok{"Charged Off"}\NormalTok{,}
                  \StringTok{"Late (16-30 days)"}\NormalTok{,}
                  \StringTok{"Default"}\NormalTok{,}
                  \StringTok{"Does not meet the credit policy. Status:Fully Paid"}\NormalTok{,}
                  \StringTok{"Does not meet the credit policy. Status:Charged Off"}\NormalTok{)}
    \ControlFlowTok{if}\NormalTok{ (loanStatusValue }\OperatorTok{!=}\StringTok{ "Any"}\NormalTok{)\{}
\NormalTok{      toReturn <-}\StringTok{ }\KeywordTok{c}\NormalTok{(loanStatusValue)}
\NormalTok{    \}}
    \KeywordTok{return}\NormalTok{(toReturn)}
\NormalTok{  \}}
  
\NormalTok{  number_of_loans_each_year <-}\StringTok{ }\KeywordTok{reactive}\NormalTok{(\{}
\NormalTok{    numberOfLoansEachYear <-}\StringTok{ }\NormalTok{lendingClubLoanData }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{ (loan_amnt }\OperatorTok{>=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{1}\NormalTok{] }\OperatorTok{&}\StringTok{ }\NormalTok{loan_amnt }\OperatorTok{<=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{2}\NormalTok{]) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(grade }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{grades) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(home_ownership }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{homeOwnerships) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_status }\OperatorTok{%in%}\StringTok{ }\KeywordTok{loanStatusFilter}\NormalTok{(}\DataTypeTok{loanStatusValue =}\NormalTok{ input}\OperatorTok{$}\NormalTok{loanStatus)) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{group_by}\NormalTok{(orig_year) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{loanCountByYear=}\KeywordTok{n}\NormalTok{())}
\NormalTok{  \})}
  
\NormalTok{  total_amount_funded_each_year <-}\StringTok{ }\KeywordTok{reactive}\NormalTok{(\{}
\NormalTok{    totalFundedAMountPerYear <-}\StringTok{ }\NormalTok{lendingClubLoanData }\OperatorTok{%>%}\StringTok{ }
\StringTok{      }\KeywordTok{filter}\NormalTok{ (loan_amnt }\OperatorTok{>=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{1}\NormalTok{] }\OperatorTok{&}\StringTok{ }\NormalTok{loan_amnt }\OperatorTok{<=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{2}\NormalTok{]) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(grade }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{grades) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(home_ownership }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{homeOwnerships) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_status }\OperatorTok{%in%}\StringTok{ }\KeywordTok{loanStatusFilter}\NormalTok{(}\DataTypeTok{loanStatusValue =}\NormalTok{ input}\OperatorTok{$}\NormalTok{loanStatus)) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{group_by}\NormalTok{(orig_year)}\OperatorTok{%>%}
\StringTok{      }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{totalFundedAmount=} \KeywordTok{sum}\NormalTok{(}\KeywordTok{as.numeric}\NormalTok{(funded_amnt)))}
\NormalTok{  \})}
  
\NormalTok{  loan_amt_term_relation <-}\StringTok{ }\KeywordTok{reactive}\NormalTok{(\{}
\NormalTok{    lendingClubLoanData }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{ (loan_amnt }\OperatorTok{>=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{1}\NormalTok{] }\OperatorTok{&}\StringTok{ }\NormalTok{loan_amnt }\OperatorTok{<=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{2}\NormalTok{]) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(grade }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{grades) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(home_ownership }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{homeOwnerships) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_status }\OperatorTok{%in%}\StringTok{ }\KeywordTok{loanStatusFilter}\NormalTok{(}\DataTypeTok{loanStatusValue =}\NormalTok{ input}\OperatorTok{$}\NormalTok{loanStatus))}
\NormalTok{  \})}
  
\NormalTok{  dti_trend <-}\StringTok{ }\KeywordTok{reactive}\NormalTok{(\{}
\NormalTok{    filtereDdtiData }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_amnt }\OperatorTok{>=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{1}\NormalTok{] }\OperatorTok{&}\StringTok{ }\NormalTok{loan_amnt }\OperatorTok{<=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{2}\NormalTok{]) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(grade }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{grades) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(home_ownership }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{homeOwnerships) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_status }\OperatorTok{%in%}\StringTok{ }\KeywordTok{loanStatusFilter}\NormalTok{(}\DataTypeTok{loanStatusValue =}\NormalTok{ input}\OperatorTok{$}\NormalTok{loanStatus))}
\NormalTok{  \})}
  
\NormalTok{  funded_amt_term_interest_relation <-}\StringTok{ }\KeywordTok{reactive}\NormalTok{(\{}
\NormalTok{    filteredLendingClubData <-}\StringTok{ }\NormalTok{filteredLendingClubData }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(annual_inc }\OperatorTok{<=}\StringTok{ }\DecValTok{300000}\NormalTok{) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_amnt }\OperatorTok{>=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{1}\NormalTok{] }\OperatorTok{&}\StringTok{ }\NormalTok{loan_amnt }\OperatorTok{<=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{2}\NormalTok{]) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(grade }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{grades) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(home_ownership }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{homeOwnerships) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_status }\OperatorTok{%in%}\StringTok{ }\KeywordTok{loanStatusFilter}\NormalTok{(}\DataTypeTok{loanStatusValue =}\NormalTok{ input}\OperatorTok{$}\NormalTok{loanStatus))}
    
\NormalTok{    groupedData <-}\StringTok{ }\NormalTok{filteredLendingClubData }\OperatorTok{%>%}\StringTok{ }
\StringTok{      }\KeywordTok{group_by}\NormalTok{(}\DataTypeTok{incomeGroup =} \KeywordTok{cut}\NormalTok{(annual_inc, }\DataTypeTok{breaks=} \KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{300000}\NormalTok{, }\DataTypeTok{by =} \DecValTok{20000}\NormalTok{), }
                                 \DataTypeTok{right =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{include.lowest =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{labels =}\NormalTok{ incomeLabels) ) }\OperatorTok{%>%}\StringTok{ }
\StringTok{      }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{averageInterest=} \KeywordTok{mean}\NormalTok{(int_rate), }\DataTypeTok{averageLoanLoanFundedAmount =} \KeywordTok{mean}\NormalTok{(funded_amnt)) }
    
\NormalTok{  \})}
  
\NormalTok{  income_trend <-}\StringTok{ }\KeywordTok{reactive}\NormalTok{(\{}
\NormalTok{    filteredAnnualIncomeData }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{ (loan_amnt }\OperatorTok{>=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{1}\NormalTok{] }\OperatorTok{&}\StringTok{ }\NormalTok{loan_amnt }\OperatorTok{<=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{2}\NormalTok{]) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(grade }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{grades) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(home_ownership }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{homeOwnerships) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_status }\OperatorTok{%in%}\StringTok{ }\KeywordTok{loanStatusFilter}\NormalTok{(}\DataTypeTok{loanStatusValue =}\NormalTok{ input}\OperatorTok{$}\NormalTok{loanStatus))}
\NormalTok{  \})}
  
\NormalTok{  loan_funded_amt_by_state <-}\StringTok{ }\KeywordTok{reactive}\NormalTok{(\{}
\NormalTok{    fundedAmountByState <-}\StringTok{ }\NormalTok{lendingClubLoanData }\OperatorTok{%>%}\StringTok{ }
\StringTok{      }\KeywordTok{filter}\NormalTok{ (loan_amnt }\OperatorTok{>=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{1}\NormalTok{] }\OperatorTok{&}\StringTok{ }\NormalTok{loan_amnt }\OperatorTok{<=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{2}\NormalTok{]) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(grade }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{grades) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(home_ownership }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{homeOwnerships) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_status }\OperatorTok{%in%}\StringTok{ }\KeywordTok{loanStatusFilter}\NormalTok{(}\DataTypeTok{loanStatusValue =}\NormalTok{ input}\OperatorTok{$}\NormalTok{loanStatus)) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{group_by}\NormalTok{(addr_state)}\OperatorTok{%>%}
\StringTok{      }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{totalFundedAmount=} \KeywordTok{sum}\NormalTok{(}\KeywordTok{as.numeric}\NormalTok{(funded_amnt)))}
    
\NormalTok{    fundedAmountByState <-}\StringTok{ }\NormalTok{fundedAmountByState }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{inner_join}\NormalTok{(fullStateNames, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"addr_state"}\NormalTok{ =}\StringTok{ "abbreviation"}\NormalTok{))}
    
\NormalTok{    states2 <-}\StringTok{ }\NormalTok{states }\OperatorTok{%>%}\StringTok{ }\KeywordTok{left_join}\NormalTok{(fundedAmountByState, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"ID"}\NormalTok{ =}\StringTok{ "state"}\NormalTok{ ))}
\NormalTok{  \})}
  
\NormalTok{  loans_by_status <-}\StringTok{ }\KeywordTok{reactive}\NormalTok{(\{}
\NormalTok{    numberOfLoansByLoanStatus <-}\StringTok{ }\NormalTok{lendingClubLoanData }\OperatorTok{%>%}\StringTok{ }
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_status }\OperatorTok{%in%}\StringTok{ }\NormalTok{loan_statuses) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_amnt }\OperatorTok{>=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{1}\NormalTok{] }\OperatorTok{&}\StringTok{ }\NormalTok{loan_amnt }\OperatorTok{<=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{2}\NormalTok{]) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(grade }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{grades) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(home_ownership }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{homeOwnerships) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_status }\OperatorTok{%in%}\StringTok{ }\KeywordTok{loanStatusFilter}\NormalTok{(}\DataTypeTok{loanStatusValue =}\NormalTok{ input}\OperatorTok{$}\NormalTok{loanStatus)) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{group_by}\NormalTok{(loan_status)}\OperatorTok{%>%}
\StringTok{      }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{numberOfLoans =} \KeywordTok{n}\NormalTok{())}
\NormalTok{  \})}
  
\NormalTok{  loans_by_purpose <-}\StringTok{ }\KeywordTok{reactive}\NormalTok{(\{}
\NormalTok{    numberOfLoansByPurpose <-}\StringTok{ }\NormalTok{lendingClubLoanData }\OperatorTok{%>%}\StringTok{ }
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_amnt }\OperatorTok{>=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{1}\NormalTok{] }\OperatorTok{&}\StringTok{ }\NormalTok{loan_amnt }\OperatorTok{<=}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{loanAmountRange[}\DecValTok{2}\NormalTok{]) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(grade }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{grades) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(home_ownership }\OperatorTok{%in%}\StringTok{ }\NormalTok{input}\OperatorTok{$}\NormalTok{homeOwnerships) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{filter}\NormalTok{(loan_status }\OperatorTok{%in%}\StringTok{ }\KeywordTok{loanStatusFilter}\NormalTok{(}\DataTypeTok{loanStatusValue =}\NormalTok{ input}\OperatorTok{$}\NormalTok{loanStatus)) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{group_by}\NormalTok{(purpose)}\OperatorTok{%>%}
\StringTok{      }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{numberOfLoans =} \KeywordTok{n}\NormalTok{())}
\NormalTok{  \})}
  
 
  
\NormalTok{  output}\OperatorTok{$}\NormalTok{loanProcessesedEachYear <-}\StringTok{ }\KeywordTok{renderPlot}\NormalTok{(\{}
    \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =} \KeywordTok{number_of_loans_each_year}\NormalTok{())}\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{color=}\StringTok{"steelblue"}\NormalTok{, }\DataTypeTok{size=}\FloatTok{1.2}\NormalTok{, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{orig_year,}\DataTypeTok{y=}\NormalTok{loanCountByYear))}\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color=}\StringTok{"steelblue"}\NormalTok{, }\DataTypeTok{size=}\FloatTok{2.5}\NormalTok{, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{orig_year,}\DataTypeTok{y=}\NormalTok{loanCountByYear))}\OperatorTok{+}
\StringTok{      }\KeywordTok{scale_x_continuous}\NormalTok{(}\DataTypeTok{breaks =} \KeywordTok{number_of_loans_each_year}\NormalTok{()}\OperatorTok{$}\NormalTok{orig_year) }\OperatorTok{+}
\StringTok{      }\KeywordTok{scale_y_continuous}\NormalTok{(}\DataTypeTok{labels =}\NormalTok{ scales}\OperatorTok{::}\KeywordTok{comma_format}\NormalTok{()) }\OperatorTok{+}
\StringTok{      }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x=}\StringTok{"Year"}\NormalTok{,}\DataTypeTok{y=}\StringTok{"# Number of loans"}\NormalTok{,}\DataTypeTok{title=}\StringTok{"Loans processed year on year (2007-2018)"}\NormalTok{)}\OperatorTok{+}
\StringTok{      }\KeywordTok{theme_minimal}\NormalTok{() }
\NormalTok{  \})}
  
\NormalTok{  output}\OperatorTok{$}\NormalTok{totalFundedLoanAmountEachYear <-}\StringTok{ }\KeywordTok{renderPlot}\NormalTok{(\{}
    \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =} \KeywordTok{total_amount_funded_each_year}\NormalTok{(), }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{orig_year, }\DataTypeTok{y=}\NormalTok{totalFundedAmount)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat=}\StringTok{"identity"}\NormalTok{, }\DataTypeTok{width=}\FloatTok{0.5}\NormalTok{, }\DataTypeTok{fill =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{scale_x_continuous}\NormalTok{(}\DataTypeTok{breaks =} \KeywordTok{total_amount_funded_each_year}\NormalTok{()}\OperatorTok{$}\NormalTok{orig_year) }\OperatorTok{+}
\StringTok{      }\KeywordTok{scale_y_continuous}\NormalTok{(}\DataTypeTok{labels =}\NormalTok{ scales}\OperatorTok{::}\NormalTok{dollar) }\OperatorTok{+}
\StringTok{      }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x =} \StringTok{"Year"}\NormalTok{, }\DataTypeTok{y =} \StringTok{"Total funded loan amount"}\NormalTok{,}\DataTypeTok{title=}\StringTok{"Total loan funded amount year on year (2007-2018)"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme_minimal}\NormalTok{() }
\NormalTok{  \})}
  
\NormalTok{  output}\OperatorTok{$}\NormalTok{loanAmtTermRelation <-}\StringTok{ }\KeywordTok{renderPlot}\NormalTok{(\{}
    \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =} \KeywordTok{loan_amt_term_relation}\NormalTok{()) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_boxplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{term, }\DataTypeTok{y=}\NormalTok{funded_amnt, }\DataTypeTok{color=}\NormalTok{term)) }\OperatorTok{+}\StringTok{ }
\StringTok{      }\KeywordTok{scale_y_continuous}\NormalTok{(}\DataTypeTok{labels =}\NormalTok{ scales}\OperatorTok{::}\NormalTok{dollar) }\OperatorTok{+}
\StringTok{      }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x =} \StringTok{"Term"}\NormalTok{, }\DataTypeTok{y =} \StringTok{"Loan funded amount"}\NormalTok{, }\DataTypeTok{title=}\StringTok{"Loan funded amount and term relation"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme_minimal}\NormalTok{() }
\NormalTok{  \})}
  
\NormalTok{  output}\OperatorTok{$}\NormalTok{fundedAmtIncomeAndInterestRelation <-}\StringTok{ }\KeywordTok{renderPlot}\NormalTok{(\{}
    \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\KeywordTok{funded_amt_term_interest_relation}\NormalTok{(), }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{incomeGroup, }\DataTypeTok{y=}\NormalTok{averageLoanLoanFundedAmount)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{colour=}\StringTok{"steelblue"}\NormalTok{, }\DataTypeTok{shape=}\DecValTok{16}\NormalTok{, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{size=}\NormalTok{averageInterest)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_smooth}\NormalTok{(}\KeywordTok{aes}\NormalTok{(incomeGroup, averageLoanLoanFundedAmount, }\DataTypeTok{group =} \DecValTok{1}\NormalTok{), }\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{scale_y_continuous}\NormalTok{(}\DataTypeTok{labels =}\NormalTok{ scales}\OperatorTok{::}\NormalTok{dollar) }\OperatorTok{+}
\StringTok{      }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x=}\StringTok{"Annual Income ($)"}\NormalTok{,}\DataTypeTok{y=}\StringTok{"Average loan funded amount"}\NormalTok{,}
           \DataTypeTok{title=}\StringTok{"Relation between funded loan Amount, income and interest rate"}\NormalTok{)}\OperatorTok{+}
\StringTok{      }\KeywordTok{guides}\NormalTok{(}\DataTypeTok{size=}\KeywordTok{guide_legend}\NormalTok{(}\StringTok{"Average }\CharTok{\textbackslash{}n}\StringTok{interest rate (%)"}\NormalTok{)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme_minimal}\NormalTok{() }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =}\DecValTok{50}\NormalTok{, }\DataTypeTok{hjust=}\FloatTok{0.75}\NormalTok{))}\OperatorTok{+}
\StringTok{      }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{legend.background =} \KeywordTok{element_rect}\NormalTok{())}
\NormalTok{  \})}

\NormalTok{  output}\OperatorTok{$}\NormalTok{incomeTrend <-}\StringTok{ }\KeywordTok{renderPlot}\NormalTok{(\{}
    \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =} \KeywordTok{income_trend}\NormalTok{(), }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ annual_inc)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_density}\NormalTok{(}\DataTypeTok{fill=}\StringTok{"steelblue"}\NormalTok{, }\DataTypeTok{color=}\StringTok{"steelblue"}\NormalTok{, }\DataTypeTok{alpha=}\FloatTok{0.8}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_vline}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{xintercept=}\KeywordTok{median}\NormalTok{(annual_inc)),}\DataTypeTok{color=}\StringTok{"green"}\NormalTok{, }\DataTypeTok{linetype=}\StringTok{"dashed"}\NormalTok{, }\DataTypeTok{size=}\DecValTok{1}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{scale_x_continuous}\NormalTok{(}\DataTypeTok{labels =}\NormalTok{ scales}\OperatorTok{::}\NormalTok{dollar) }\OperatorTok{+}
\StringTok{      }\KeywordTok{scale_y_continuous}\NormalTok{(}\DataTypeTok{labels =} \ControlFlowTok{function}\NormalTok{(x) }\KeywordTok{format}\NormalTok{(x, }\DataTypeTok{scientific =} \OtherTok{FALSE}\NormalTok{)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x=}\StringTok{"Annual income"}\NormalTok{,}\DataTypeTok{y=}\StringTok{"Density of loans"}\NormalTok{,}\DataTypeTok{title=}\StringTok{"Annual income distribution"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme_minimal}\NormalTok{()}
\NormalTok{  \})}
  
\NormalTok{  output}\OperatorTok{$}\NormalTok{loanFundedAmtByState <-}\StringTok{ }\KeywordTok{renderPlot}\NormalTok{(\{}
    \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =} \KeywordTok{loan_funded_amt_by_state}\NormalTok{()) }\OperatorTok{+}\StringTok{ }
\StringTok{      }\KeywordTok{geom_sf}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{fill =}\NormalTok{ totalFundedAmount)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{scale_fill_viridis_c}\NormalTok{(}\StringTok{"Loan funded amount"}\NormalTok{, }\DataTypeTok{labels =}\NormalTok{ scales}\OperatorTok{::}\NormalTok{dollar) }\OperatorTok{+}
\StringTok{      }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Total loan funded amount by state"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme_minimal}\NormalTok{()}
\NormalTok{  \})}
  
\NormalTok{  output}\OperatorTok{$}\NormalTok{dtiTrend <-}\StringTok{ }\KeywordTok{renderPlot}\NormalTok{(\{}
    \KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =} \KeywordTok{dti_trend}\NormalTok{(), }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ dti)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_density}\NormalTok{(}\DataTypeTok{fill=}\StringTok{"steelblue"}\NormalTok{, }\DataTypeTok{color=}\StringTok{"steelblue"}\NormalTok{, }\DataTypeTok{alpha=}\FloatTok{0.8}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_vline}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{xintercept=}\KeywordTok{median}\NormalTok{(dti)),}\DataTypeTok{color=}\StringTok{"green"}\NormalTok{, }\DataTypeTok{linetype=}\StringTok{"dashed"}\NormalTok{, }\DataTypeTok{size=}\DecValTok{1}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x=}\StringTok{"Debt to Income Ratio (DTI) %"}\NormalTok{,}\DataTypeTok{y=}\StringTok{"Density of loans"}\NormalTok{,}
           \DataTypeTok{title=}\StringTok{"Loan distribution across DTI (Excluded > 100"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme_minimal}\NormalTok{()}
\NormalTok{  \})}
  
\NormalTok{  output}\OperatorTok{$}\NormalTok{loansByStatus <-}\StringTok{ }\KeywordTok{renderPlot}\NormalTok{(\{}
    \KeywordTok{ggplot}\NormalTok{(}\KeywordTok{loans_by_status}\NormalTok{(), }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{loan_status, }\DataTypeTok{y=}\NormalTok{numberOfLoans)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat=}\StringTok{"identity"}\NormalTok{, }\DataTypeTok{width=}\FloatTok{0.5}\NormalTok{, }\DataTypeTok{fill =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_text}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{label=}\NormalTok{numberOfLoans), }\DataTypeTok{vjust=}\OperatorTok{-}\FloatTok{0.3}\NormalTok{, }\DataTypeTok{size=}\FloatTok{3.5}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{scale_y_continuous}\NormalTok{(}\DataTypeTok{labels =}\NormalTok{ scales}\OperatorTok{::}\KeywordTok{comma_format}\NormalTok{()) }\OperatorTok{+}
\StringTok{      }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x =} \StringTok{"Loan Status"}\NormalTok{, }\DataTypeTok{y =} \StringTok{"Number of Loans (#)"}\NormalTok{,}\DataTypeTok{title=}\StringTok{"# Loans by status"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme_minimal}\NormalTok{() }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =}\DecValTok{50}\NormalTok{, }\DataTypeTok{hjust=}\FloatTok{0.75}\NormalTok{))}
\NormalTok{  \})}
  
\NormalTok{  output}\OperatorTok{$}\NormalTok{loansByPurpose <-}\StringTok{ }\KeywordTok{renderPlot}\NormalTok{(\{}
    \KeywordTok{ggplot}\NormalTok{(}\KeywordTok{loans_by_purpose}\NormalTok{(), }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{purpose, }\DataTypeTok{y=}\NormalTok{numberOfLoans)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat=}\StringTok{"identity"}\NormalTok{, }\DataTypeTok{width=}\FloatTok{0.5}\NormalTok{, }\DataTypeTok{fill =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{scale_y_continuous}\NormalTok{(}\DataTypeTok{labels =}\NormalTok{ scales}\OperatorTok{::}\KeywordTok{comma_format}\NormalTok{()) }\OperatorTok{+}
\StringTok{      }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x =} \StringTok{"Loan Purpose"}\NormalTok{, }\DataTypeTok{y =} \StringTok{"Number of Loans (#)"}\NormalTok{,}\DataTypeTok{title=}\StringTok{"# Loans by purpose"}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme_minimal}\NormalTok{() }\OperatorTok{+}
\StringTok{      }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =}\DecValTok{50}\NormalTok{, }\DataTypeTok{hjust=}\FloatTok{0.75}\NormalTok{))}
\NormalTok{  \})}
  
\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\#ui.R code

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#}
\CommentTok{# This is the user-interface definition of a Shiny web application. You can}
\CommentTok{# run the application by clicking 'Run App' above.}
\CommentTok{#}
\CommentTok{# Find out more about building applications with Shiny here:}
\CommentTok{#}
\CommentTok{#    http://shiny.rstudio.com/}
\CommentTok{#}

\KeywordTok{library}\NormalTok{(shiny)}
\KeywordTok{library}\NormalTok{(shinythemes)}
\KeywordTok{library}\NormalTok{(shinycssloaders)}
\CommentTok{# Define UI for application that draws a histogram}
\KeywordTok{shinyUI}\NormalTok{(}\KeywordTok{fluidPage}\NormalTok{(}
    \DataTypeTok{theme =} \KeywordTok{shinytheme}\NormalTok{(}\StringTok{"slate"}\NormalTok{),}
    \CommentTok{# Application title}
    \KeywordTok{titlePanel}\NormalTok{(}\StringTok{""}\NormalTok{),}
    \KeywordTok{titlePanel}\NormalTok{(}\DataTypeTok{title=}\KeywordTok{div}\NormalTok{(}\DataTypeTok{style=}\StringTok{"display:inline-block;width:100%;"}\NormalTok{,}
                         \KeywordTok{img}\NormalTok{(}\DataTypeTok{src=}\StringTok{"homelogo.png"}\NormalTok{, }\DataTypeTok{style=}\StringTok{"height:100px;"}\NormalTok{), }\StringTok{"Data analysis (2007-2018)"}\NormalTok{), }
               \DataTypeTok{windowTitle =} \StringTok{"Lending club data analysis"}\NormalTok{),}
    
    \CommentTok{# Sidebar with a slider input for number of bins}
    \KeywordTok{sidebarLayout}\NormalTok{(}
        \KeywordTok{sidebarPanel}\NormalTok{(}
            \CommentTok{# Price Range filter}
            \KeywordTok{sliderInput}\NormalTok{(}\StringTok{"loanAmountRange"}\NormalTok{,}
                        \StringTok{"Loan Amount:"}\NormalTok{,}
                        \DataTypeTok{pre =} \StringTok{"$"}\NormalTok{,}
                        \DataTypeTok{min =} \DecValTok{500}\NormalTok{,}
                        \DataTypeTok{max =} \DecValTok{40000}\NormalTok{,}
                        \DataTypeTok{value =} \KeywordTok{c}\NormalTok{(}\DecValTok{500}\NormalTok{, }\DecValTok{40000}\NormalTok{)),}
            \CommentTok{# Horizontal line ----}
\NormalTok{            tags}\OperatorTok{$}\KeywordTok{hr}\NormalTok{(),}
            
            \CommentTok{# House condition filter}
            \KeywordTok{checkboxGroupInput}\NormalTok{(}\DataTypeTok{inputId =} \StringTok{"grades"}\NormalTok{,}
                               \DataTypeTok{label =}\StringTok{"Grade:"}\NormalTok{,}
                               \DataTypeTok{choiceNames =} \KeywordTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"D"}\NormalTok{, }\StringTok{"E"}\NormalTok{, }\StringTok{"F"}\NormalTok{, }\StringTok{"G"}\NormalTok{),  }
                               \DataTypeTok{choiceValues =} \KeywordTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"D"}\NormalTok{, }\StringTok{"E"}\NormalTok{, }\StringTok{"F"}\NormalTok{, }\StringTok{"G"}\NormalTok{),}
                               \DataTypeTok{selected =} \KeywordTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"D"}\NormalTok{, }\StringTok{"E"}\NormalTok{, }\StringTok{"F"}\NormalTok{, }\StringTok{"G"}\NormalTok{),}
                               \DataTypeTok{inline =} \OtherTok{TRUE}\NormalTok{),}
            \CommentTok{# Horizontal line ----}
\NormalTok{            tags}\OperatorTok{$}\KeywordTok{hr}\NormalTok{(),}
            
            \CommentTok{# House condition filter}
            \KeywordTok{checkboxGroupInput}\NormalTok{(}\DataTypeTok{inputId =} \StringTok{"homeOwnerships"}\NormalTok{,}
                               \DataTypeTok{label =}\StringTok{"Home Ownership:"}\NormalTok{,}
                               \DataTypeTok{choiceNames =} \KeywordTok{c}\NormalTok{(}\StringTok{"ANY"}\NormalTok{, }\StringTok{"RENT"}\NormalTok{, }\StringTok{"MORTGAGE"}\NormalTok{, }\StringTok{"OWN"}\NormalTok{),  }
                               \DataTypeTok{choiceValues =} \KeywordTok{c}\NormalTok{(}\StringTok{"ANY"}\NormalTok{, }\StringTok{"RENT"}\NormalTok{, }\StringTok{"MORTGAGE"}\NormalTok{, }\StringTok{"OWN"}\NormalTok{),}
                               \DataTypeTok{selected =} \KeywordTok{c}\NormalTok{(}\StringTok{"ANY"}\NormalTok{, }\StringTok{"RENT"}\NormalTok{, }\StringTok{"MORTGAGE"}\NormalTok{, }\StringTok{"OWN"}\NormalTok{),}
                               \DataTypeTok{inline =} \OtherTok{TRUE}\NormalTok{),}
            \CommentTok{# Horizontal line ----}
\NormalTok{            tags}\OperatorTok{$}\KeywordTok{hr}\NormalTok{(),}
            
            
            \CommentTok{# Number of bedrooms filter}
            \KeywordTok{selectInput}\NormalTok{(}\StringTok{"loanStatus"}\NormalTok{, }\StringTok{"Loan Status:"}\NormalTok{,}
                        \KeywordTok{c}\NormalTok{(}
                            \StringTok{"Any"}\NormalTok{ =}\StringTok{ "Any"}\NormalTok{,}
                            \StringTok{"Current"}\NormalTok{ =}\StringTok{ "Current"}\NormalTok{,}
                            \StringTok{"Fully Paid"}\NormalTok{ =}\StringTok{ "Fully Paid"}\NormalTok{,}
                            \StringTok{"Late (31-120 days)"}\NormalTok{ =}\StringTok{ "Late (31-120 days)"}\NormalTok{,}
                            \StringTok{"In Grace Period"}\NormalTok{ =}\StringTok{ "In Grace Period"}\NormalTok{,}
                            \StringTok{"Charged Off"}\NormalTok{ =}\StringTok{ "Charged Off"}\NormalTok{,}
                            \StringTok{"Late (16-30 days)"}\NormalTok{ =}\StringTok{ "Late (16-30 days)"}\NormalTok{,}
                            \StringTok{"Default"}\NormalTok{ =}\StringTok{ "Default"}\NormalTok{,}
                            \StringTok{"Does not meet the credit policy. Status:Fully Paid"}\NormalTok{ =}\StringTok{ "Does not meet the credit policy. Status:Fully Paid"}\NormalTok{,}
                            \StringTok{"Does not meet the credit policy. Status:Charged Off"}\NormalTok{ =}\StringTok{ "Does not meet the credit policy. Status:Charged Off"}
\NormalTok{                        )),}
            \CommentTok{# Horizontal line ----}
\NormalTok{            tags}\OperatorTok{$}\KeywordTok{hr}\NormalTok{(),}
            
            \CommentTok{# Price Range filter}
            \KeywordTok{sliderInput}\NormalTok{(}\StringTok{"dti"}\NormalTok{,}
                        \StringTok{"Debt to Income Ratio:"}\NormalTok{,}
                        \DataTypeTok{pre =} \StringTok{"%"}\NormalTok{,}
                        \DataTypeTok{min =} \DecValTok{-1}\NormalTok{,}
                        \DataTypeTok{max =} \DecValTok{999}\NormalTok{,}
                        \DataTypeTok{value =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{100}\NormalTok{)),}
            \CommentTok{# Horizontal line ----}
\NormalTok{            tags}\OperatorTok{$}\KeywordTok{hr}\NormalTok{(),}
\NormalTok{            tags}\OperatorTok{$}\KeywordTok{div}\NormalTok{(}\DataTypeTok{style=}\StringTok{"display:inline-block;width:100%;color:#e48806"}\NormalTok{, }
                     \StringTok{"** Due to large dataset size, visualizations and filters may run slow **"}\NormalTok{),}
\NormalTok{         ),}
        
        \CommentTok{# Show a plot of the generated distribution}
        \KeywordTok{mainPanel}\NormalTok{(}
            \KeywordTok{tabsetPanel}\NormalTok{(}
                \KeywordTok{tabPanel}\NormalTok{(}\StringTok{"Year wise loans trend"}\NormalTok{, shinycssloaders}\OperatorTok{::}\KeywordTok{withSpinner}\NormalTok{(}\KeywordTok{plotOutput}\NormalTok{(}\StringTok{"loanProcessesedEachYear"}\NormalTok{)), }
\NormalTok{                         shinycssloaders}\OperatorTok{::}\KeywordTok{withSpinner}\NormalTok{(}\KeywordTok{plotOutput}\NormalTok{(}\StringTok{"totalFundedLoanAmountEachYear"}\NormalTok{))),}
                \KeywordTok{tabPanel}\NormalTok{(}\StringTok{"Loan Amount, Term Relation"}\NormalTok{, }
\NormalTok{                         shinycssloaders}\OperatorTok{::}\KeywordTok{withSpinner}\NormalTok{(}\KeywordTok{plotOutput}\NormalTok{(}\StringTok{"loanAmtTermRelation"}\NormalTok{, }\DataTypeTok{height=}\StringTok{"700px"}\NormalTok{))),}
                \KeywordTok{tabPanel}\NormalTok{(}\StringTok{"DTI Trend"}\NormalTok{, }
\NormalTok{                         shinycssloaders}\OperatorTok{::}\KeywordTok{withSpinner}\NormalTok{(}\KeywordTok{plotOutput}\NormalTok{(}\StringTok{"dtiTrend"}\NormalTok{, }\DataTypeTok{height=}\StringTok{"700px"}\NormalTok{))),}
                \KeywordTok{tabPanel}\NormalTok{(}\StringTok{"Loan Amount, Income, Interest Relation"}\NormalTok{, }
\NormalTok{                         shinycssloaders}\OperatorTok{::}\KeywordTok{withSpinner}\NormalTok{(}\KeywordTok{plotOutput}\NormalTok{(}\StringTok{"fundedAmtIncomeAndInterestRelation"}\NormalTok{)),}
\NormalTok{                         shinycssloaders}\OperatorTok{::}\KeywordTok{withSpinner}\NormalTok{(}\KeywordTok{plotOutput}\NormalTok{(}\StringTok{"incomeTrend"}\NormalTok{))),}
                \KeywordTok{tabPanel}\NormalTok{(}\StringTok{"Loan Amount by state"}\NormalTok{, }
\NormalTok{                         shinycssloaders}\OperatorTok{::}\KeywordTok{withSpinner}\NormalTok{(}\KeywordTok{plotOutput}\NormalTok{(}\StringTok{"loanFundedAmtByState"}\NormalTok{, }\DataTypeTok{height=}\StringTok{"700px"}\NormalTok{))),}
                \KeywordTok{tabPanel}\NormalTok{(}\StringTok{"Loans status and purpose"}\NormalTok{, }
\NormalTok{                         shinycssloaders}\OperatorTok{::}\KeywordTok{withSpinner}\NormalTok{(}\KeywordTok{plotOutput}\NormalTok{(}\StringTok{"loansByStatus"}\NormalTok{)),}
\NormalTok{                         shinycssloaders}\OperatorTok{::}\KeywordTok{withSpinner}\NormalTok{(}\KeywordTok{plotOutput}\NormalTok{(}\StringTok{"loansByPurpose"}\NormalTok{)))}
\NormalTok{            )}
\NormalTok{        ),}
       
\NormalTok{    )}
\NormalTok{))}
\end{Highlighting}
\end{Shaded}


\end{document}
